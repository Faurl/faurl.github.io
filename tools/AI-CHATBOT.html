<!DOCTYPE html>
<html>
<head>
	<title>Adavanced AI Chatbot</title>
	<link rel=icon href="../assets/media/icons/tools/assistant5.png">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
 	html{height: 100%;}

	body {
		background-color: darkgray;
		background-image:linear-gradient(180deg,rgba(255, 153, 0, 1) 0%, rgba(82, 0, 83, 1) 70%, rgba(0, 0, 0, 1) 100%);

		font-size: 150%;
		margin: 0;
		height: 100%;
	}
	h2 {
		color: white;
		font-family: Bahnschrift; /*Helvetica, sans-serif*/
		font-weight: normal;
		font-stretch: ultra-expanded;
	  	text-align: center;
	  	display: block;
	  	margin: 0 0 .4em 0;
	}
	main{
		display: grid;
  		place-items: center;
  		padding: 10%;
	}
	#disclaimer {
		text-align: center;
		font-family: Bahnschrift;
		opacity: 20%;
		font-size: 13px;
		position: absolute;
		bottom: 0; left: 0; right: 0;
		padding: 3px;
	}
	#disclaimer a:link, #disclaimer a:visited, #disclaimer{color: darkgray;}
	#disclaimer a:hover{color: lightgray;}

	#chatbot {
		width: 400px;
	}
	.expand-chatbot {width: 800px !important;}
	.expand-chat {
		opacity: 100% !important;
		height: 360px !important;
	}
	.expand-userinput{
		transform: translateY(0px) !important;
		border-radius: 0 0 30px 30px !important;
		border-top: none;
		margin: 0 0 0 0 !important;
	}

	.expand-h2 {
		text-align: left;
		margin-left: 30px;
	}

	.expand-h2, .expand-chat, .expand-chatbot, .expand-userinput{
		transition: ease-out 0.5s;
	}
	#chat, #chatbot, h2, #userinput {}

	#chat, #userinput {
		font-family: Bahnschrift;
		width: 100%;
		border:2.5px solid white;
		box-sizing: border-box;
		backdrop-filter: blur(20px);
		background-color: rgba(255, 255, 255, .4);
		font-size: 100%;
	}

	#userinput {
		transform: translateY(-50px);
		background-color: rgba(255, 255, 255, .5);
		padding: 10px;
		padding-left: 30px;
		padding-right: 30px;
		font-size: 90%;
		border-radius: 50px 50px 50px 50px;
		margin: .8em 0 0 0;
		transition: ease 0.3s;
	}
	#userinput:focus{outline: 0;background-color: rgba(255, 255, 255, .6);}
	#userinput::placeholder{color:black;opacity: 27%}

	#chat {
		opacity: 0;
		font-size:21px;
		padding:20px;
		padding-top:5px;
		border-radius: 30px 30px 0 0;
		border-bottom: none;
		height: 0;
		margin: 0;
		overflow-y: scroll;
		/* Hide scrollbar for IE, Edge and Firefox */
		-ms-overflow-style: none;  /* IE and Edge */
  		scrollbar-width: none;  /* Firefox */
	}
	/* Hide scrollbar for Chrome, Safari and Opera */
	#chat::-webkit-scrollbar {display: none;}

	.fade_show {
		opacity: 100% !important;
		/*transition: 0.8s !important;*/
	}

	.answer{
		opacity: 0%;
	}

	.answer, .thinking{
		background-color: rgba(255, 255, 255, .3);
		border-radius: 10px;
	}

	.thinking {
		color: white;
		display: table;
	}


	.user-message, .answer, .thinking{padding: 7px; padding-left: 10px}

	.user-message::before{content: "[You]: ";color: blueviolet;}
	.answer::before{content: "[AI CHATBOT]: ";color: mediumseagreen; font-weight: bold;} /*text-shadow: 2px 2px 2px black*/


	.loader{
		display: inline-block;
		width: 20px;
		height: 20px;
		border: 5px solid rgba(255, 255, 255, .3);
		border-top: 5px solid white;
		border-radius: 50%;
		margin-left: 10px;
		margin-bottom: -7px;
		margin-right: 4px;
		animation: spin 2s linear infinite;
	}
	@keyframes spin {
		0% {transform:rotate(0deg);}
		100% {transform:rotate(360deg);}
	}
</style>
</head>
<body>
	<main>
		<div id="chatbot">
			<h2 id="header">Advanced AI assistant</h2>
			<div id="chat"></div>
			<div id="input-cont">
				<input id="userinput" placeholder="Type to start learning . . ." autofocus=true autocomplete="off"></input>
			</div>
		</div>
		<span id="disclaimer">By using ‚ÄúAdvanced AI assistant‚Äù you accept OpenAI‚Äôs <a href="./../docs/assistant-privacy-policy.html">Privacy Policy and Terms of Service</a>.</span>
	</main>
</body>
<script type="text/javascript">

const userinput = document.getElementById("userinput");
const chat = document.getElementById("chat");
const mainApp = document.getElementById("chatbot");
const header = document.getElementById("header");
let latest_message = '';
let can_send = true;
let expanded_thingies = false;
let expand_time = 400;

function randomNum(min,max) {return Math.floor(Math.random() * (max - min)) + min;}
function bottomscroll(){chat.scrollTo(0, chat.scrollHeight);}

userinput.addEventListener('keydown', function(event) {
    if (event.key === 'Enter' && !userinput.value == '' && can_send == true) {
        latest_message = userinput.value;
        userinput.value = '';
        randomAnswer();

	    if(expanded_thingies == false){
	    		mainApp.classList.add("expand-chatbot");
				header.classList.add("expand-h2");
	    	setTimeout(function(){
				chat.classList.add("expand-chat");
	    		userinput.classList.add("expand-userinput");
	    	},expand_time);

			expanded_thingies = true;
    	}
    }
    if (event.key === 'ArrowUp') {userinput.value = latest_message}
    if (event.key === 'ArrowDown') {userinput.value = ''}
});

const answers = [
	`I don't know.`,
	`Your last message contains language that violates our content policy. Please reword your response.`,
	`I can't assist with that topic.`,
	`We are currently experiencing higher traffic than expected. Please wait a moment and resend your last message.`,
	`I can only provide support in English right now.`,
	`[Error ‚ùå]`,
	`<br><p style="margin-top:10px;">Look! I just generated this beautiful triceratops in less than 10 seconds!</p><img src="./../assets/media/image/ai_dino.png" height="120px">`,
	//`[Critical Error ‚ùå] Try clearing cookies and browsing data or reinstall your browser.`,
	`sybau`//üíîü•Ä
];

function randomAnswer() {
	can_send = false;
	var i = randomNum(0, answers.length);
	var answer_delay = randomNum(3000,8000);
	var display_delay = 500;

	usermessage = document.createElement("p");
	usermessage.innerHTML = latest_message;
	usermessage.classList.add("user-message");
	chat.appendChild(usermessage);

	answer = document.createElement("p");
	answer.classList.add("thinking");
	answer.innerHTML = "Thinking";
	chat.appendChild(answer);

	setTimeout(function(){answer.classList.add("fade_show")},display_delay);

	loading = document.createElement("div");
	loading.classList.add("loader");
	answer.appendChild(loading);

	setTimeout(function(){

		loading.remove();
		answer.classList.remove("thinking");
		answer.classList.add("answer");
		answer.innerHTML = answers[i];

		//console.log("Input: "+usermessage.innerHTML);
		//console.log("Answer: "+answer.innerHTML);
		bottomscroll();
		can_send = true;

	},display_delay+answer_delay);
	bottomscroll();
}

//TO-DO: hacer icono¬°'¬°'¬°''

</script>
</html>